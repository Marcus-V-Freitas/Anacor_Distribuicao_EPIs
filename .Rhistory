mid = "white",
high = "#FDE725FF",
midpoint = 0) +
labs(x = NULL, y = NULL) +
theme(legend.title = element_blank(),
panel.background = element_rect("white"),
legend.position = "none",
axis.text.x = element_text(angle = 90))
tab <- table(epis$requisitante,
epis$material)
tab
# Mapa de calor dos resíduos padronizados ajustados
data.frame(qui2$stdres) %>%
rename(country = 1,
let_q5 = 2) %>%
ggplot(aes(x = country, y = let_q5, fill = Freq, label = round(Freq,3))) +
geom_tile() +
geom_text(size = 3, angle = 90) +
scale_fill_gradient2(low = "#440154FF",
mid = "white",
high = "#FDE725FF",
midpoint = 0) +
labs(x = NULL, y = NULL) +
theme(legend.title = element_blank(),
panel.background = element_rect("white"),
legend.position = "none",
axis.text.x = element_text(angle = 90))
qui2 <- chisq.test(tab,simulate.p.value = T)
qui2
# Mapa de calor dos resíduos padronizados ajustados
data.frame(qui2$stdres) %>%
rename(country = 1,
let_q5 = 2) %>%
ggplot(aes(x = country, y = let_q5, fill = Freq, label = round(Freq,3))) +
geom_tile() +
geom_text(size = 3, angle = 90) +
scale_fill_gradient2(low = "#440154FF",
mid = "white",
high = "#FDE725FF",
midpoint = 0) +
labs(x = NULL, y = NULL) +
theme(legend.title = element_blank(),
panel.background = element_rect("white"),
legend.position = "none",
axis.text.x = element_text(angle = 90))
qui2 <- chisq.test(tab,simulate.p.value = T)
qui2
# Mapa de calor dos resíduos padronizados ajustados
data.frame(qui2$stdres) %>%
rename(country = 1,
let_q5 = 2) %>%
ggplot(aes(x = country, y = let_q5, fill = Freq, label = round(Freq,3))) +
geom_tile() +
geom_text(size = 3, angle = 90) +
scale_fill_gradient2(low = "#440154FF",
mid = "white",
high = "#FDE725FF",
midpoint = 0) +
labs(x = NULL, y = NULL) +
theme(legend.title = element_blank(),
panel.background = element_rect("white"),
legend.position = "none",
axis.text.x = element_text(angle = 90))
anacor <- CA(tab)
ca_coordenadas <- rbind(anacor$row$coord, anacor$col$coord)
ca_coordenadas
id_var <- apply(epis,
MARGIN =  2,
FUN = function(x) nlevels(as.factor(x)))
id_var
ca_coordenadas_final <- data.frame(ca_coordenadas,
Variable = rep(names(id_var), id_var))
ca_coordenadas_final
options(ggrepel.max.overlaps = Inf)
ca_coordenadas_final %>%
rownames_to_column() %>%
rename(Category = 1) %>%
ggplot(aes(x = Dim.1,
y = Dim.2,
label = Category,
color = Variable,
shape = Variable)) +
geom_point(size = 3) +
geom_label_repel() +
geom_hline(yintercept = 0, linetype = "dashed") +
geom_vline(xintercept = 0, linetype = "dashed") +
labs(x = paste("Dimension 1:", paste0(round(anacor$eig[1,2], digits = 2), "%")),
y = paste("Dimension 2:", paste0(round(anacor$eig[2,2], digits = 2), "%"))) +
scale_color_viridis_d() +
theme(panel.background = element_rect("white"),
panel.border = element_rect("NA"),
panel.grid = element_line("gray95"),
legend.position = "none")
coordenadas_linhas <- anacor$row$coord
coordenadas_linhas
# Capturando as coordenadas das categorias da variável disposta em coluna
coordenadas_colunas <- anacor$col$coord
coordenadas_colunas
mapa_perceptual_3D <- plot_ly()
mapa_perceptual_3D
# Inserindo as coordenadas das categorias da variável disposta em linha
mapa_perceptual_3D <- add_trace(mapa_perceptual_3D,
x = coordenadas_linhas[,1],
y = coordenadas_linhas[,2],
z = coordenadas_linhas[,3],
mode = "text",
text = rownames(coordenadas_linhas),
textfont = list(color = "#440154FF"),
showlegend = FALSE)
# Inserindo as coordenadas das categorias da variável disposta em coluna
mapa_perceptual_3D <- add_trace(mapa_perceptual_3D,
x = coordenadas_colunas[,1],
y = coordenadas_colunas[,2],
z = coordenadas_colunas[,3],
mode = "text",
text = rownames(coordenadas_colunas),
textfont = list(color = "#287C8EFF"),
showlegend = FALSE)
# Inserindo o nome dos eixos (Dimensão 1, Dimensão 2 e Dimensão 3)
mapa_perceptual_3D <- layout(mapa_perceptual_3D,
scene = list(xaxis = list(title = colnames(coordenadas_linhas)[1]),
yaxis = list(title = colnames(coordenadas_linhas)[2]),
zaxis = list(title = colnames(coordenadas_linhas)[3]),
aspectmode = "data"),
margin = list(l = 0, r = 0, b = 0, t = 0))
mapa_perceptual_3D
View(epis)
epis <- read.csv('distribuicao_epi.csv',header = T,sep=";")
View(epis)
CA()
library(plotly) #Montagem de gráficos 3D interativos
library(tidyverse) #Biblioteca com funcionalidades gerais para ciência de dados
library(ggrepel) #Afastar rótulos de texto que podem ser sobreescrever
library(knitr) #Geração de relatórios dinâmicos
library(kableExtra) #Permite criação de tabelas HTML estilizadas
library(FactoMineR) #Realizar a análise de correspondência simples
options(ggrepel.max.overlaps = Inf) #Permitir que mais rótulos sejam afastados
epis <- read.csv('distribuicao_epi.csv',header = T,sep=";")
head(epis)
epis <- epis[,c('material','requisitante')]
summary(epis)
epis %>%
kable() %>%
kable_styling(bootstrap_options = "striped",
full_width = TRUE,
font_size = 12)
tab <- table(epis$requisitante,
epis$material)
tab
qui2 <- chisq.test(tab,simulate.p.value = T)
qui2
# Mapa de calor dos resíduos padronizados ajustados
data.frame(qui2$stdres) %>%
rename(country = 1,
let_q5 = 2) %>%
ggplot(aes(x = country, y = let_q5, fill = Freq, label = round(Freq,3))) +
geom_tile() +
geom_text(size = 3, angle = 90) +
scale_fill_gradient2(low = "#440154FF",
mid = "white",
high = "#FDE725FF",
midpoint = 0) +
labs(x = NULL, y = NULL) +
theme(legend.title = element_blank(),
panel.background = element_rect("white"),
legend.position = "none",
axis.text.x = element_text(angle = 90))
anacor <- CA(tab)
ca_coordenadas <- rbind(anacor$row$coord, anacor$col$coord)
ca_coordenadas
id_var <- apply(epis,
MARGIN =  2,
FUN = function(x) nlevels(as.factor(x)))
id_var
ca_coordenadas_final <- data.frame(ca_coordenadas,
Variable = rep(names(id_var), id_var))
ca_coordenadas_final
ca_coordenadas_final %>%
rownames_to_column() %>%
rename(Category = 1) %>%
ggplot(aes(x = Dim.1,
y = Dim.2,
label = Category,
color = Variable,
shape = Variable)) +
geom_point(size = 3) +
geom_label_repel() +
geom_hline(yintercept = 0, linetype = "dashed") +
geom_vline(xintercept = 0, linetype = "dashed") +
labs(x = paste("Dimension 1:", paste0(round(anacor$eig[1,2], digits = 2), "%")),
y = paste("Dimension 2:", paste0(round(anacor$eig[2,2], digits = 2), "%"))) +
scale_color_viridis_d() +
theme(panel.background = element_rect("white"),
panel.border = element_rect("NA"),
panel.grid = element_line("gray95"),
legend.position = "none")
coordenadas_linhas <- anacor$row$coord
coordenadas_linhas
# Capturando as coordenadas das categorias da variável disposta em coluna
coordenadas_colunas <- anacor$col$coord
coordenadas_colunas
mapa_perceptual_3D <- plot_ly()
# Inserindo as coordenadas das categorias da variável disposta em linha
mapa_perceptual_3D <- add_trace(mapa_perceptual_3D,
x = coordenadas_linhas[,1],
y = coordenadas_linhas[,2],
z = coordenadas_linhas[,3],
mode = "text",
text = rownames(coordenadas_linhas),
textfont = list(color = "#440154FF"),
showlegend = FALSE)
# Inserindo as coordenadas das categorias da variável disposta em coluna
mapa_perceptual_3D <- add_trace(mapa_perceptual_3D,
x = coordenadas_colunas[,1],
y = coordenadas_colunas[,2],
z = coordenadas_colunas[,3],
mode = "text",
text = rownames(coordenadas_colunas),
textfont = list(color = "#287C8EFF"),
showlegend = FALSE)
# Inserindo o nome dos eixos (Dimensão 1, Dimensão 2 e Dimensão 3)
mapa_perceptual_3D <- layout(mapa_perceptual_3D,
scene = list(xaxis = list(title = colnames(coordenadas_linhas)[1]),
yaxis = list(title = colnames(coordenadas_linhas)[2]),
zaxis = list(title = colnames(coordenadas_linhas)[3]),
aspectmode = "data"),
margin = list(l = 0, r = 0, b = 0, t = 0))
mapa_perceptual_3D
# Mapa de calor dos resíduos padronizados ajustados
data.frame(qui2$stdres) %>%
rename(country = 1,
let_q5 = 2) %>%
ggplot(aes(x = country, y = let_q5, fill = Freq, label = round(Freq,3))) +
geom_tile() +
geom_text(size = 3, angle = 90) +
scale_fill_gradient2(low = "#440154FF",
mid = "white",
high = "#FDE725FF",
midpoint = 0) +
labs(x = NULL, y = NULL) +
theme(legend.title = "Resíduos Padronizados Ajustados",
panel.background = element_rect("white"),
legend.position = "none",
axis.text.x = element_text(angle = 90))
# Mapa de calor dos resíduos padronizados ajustados
data.frame(qui2$stdres) %>%
rename(country = 1,
let_q5 = 2) %>%
ggplot(aes(x = country, y = let_q5, fill = Freq, label = round(Freq,3))) +
geom_tile() +
geom_text(size = 3, angle = 90) +
scale_fill_gradient2(low = "#440154FF",
mid = "white",
high = "#FDE725FF",
midpoint = 0) +
labs(x = NULL, y = NULL) +
element_text(title("ola"))+
theme(legend.title = element_blank(),
panel.background = element_rect("white"),
legend.position = "none",
axis.text.x = element_text(angle = 90))
# Mapa de calor dos resíduos padronizados ajustados
data.frame(qui2$stdres) %>%
rename(requisitante = 1,
material = 2) %>%
ggplot(aes(x = requisitante, y = material, fill = Freq, label = round(Freq,3))) +
geom_tile() +
geom_text(size = 3, angle = 90) +
scale_fill_gradient2(low = "#440154FF",
mid = "white",
high = "#FDE725FF",
midpoint = 0) +
labs(x = NULL, y = NULL) +
theme(legend.title = element_blank(),
panel.background = element_rect("white"),
legend.position = "none",
axis.text.x = element_text(angle = 90))
head(epis) %>%
kable() %>%
kable_styling(bootstrap_options = "striped",
full_width = TRUE,
font_size = 12)
![Logo SUS](logo-sus.png)
![Logo SUS]("logo-sus.png")
![Logo SUS]("logo-sus.png")
![Logo SUS]("logo-sus.png")
View(epis)
epis <- read.csv('distribuicao_epi.csv',header = T,sep=";")
as.character(unique(unlist(epis[,c('status')])))
View(epis)
epis <- epis[,c('material','requisitante')]
summary(epis)
head(epis) %>%
kable() %>%
kable_styling(bootstrap_options = "striped",
font_size = 12)
head(epis) %>%
kable() %>%
kable_styling(bootstrap_options = "striped",
full_width = TRUE,
font_size = 12)
library(cabootcrs)
head(epis) %>%
kable() %>%
kable_styling(bootstrap_options = "striped",
full_width = TRUE,
font_size = 12)
plotly
plotly
plotly
plotly
plotly
plotly
plotly
library(tidyverse) #Biblioteca com funcionalidades gerais para ciência de dados
library(tidyverse) #Biblioteca com funcionalidades gerais para ciência de dados
library(ggrepel) #Afastar rótulos de texto que podem ser sobreescrever
library(knitr) #Geração de relatórios dinâmicos
library(kableExtra) #Permite criação de tabelas HTML estilizadas
library(FactoMineR) #Realizar a análise de correspondência simples
library(cabootcrs)
head(epis) %>%
kable() %>%
kable_styling(bootstrap_options = "striped",
full_width = TRUE,
font_size = 12)
head(epis) %>%
kable() %>%
kable_styling(bootstrap_options = "striped",
font_size = 12)
anacor$eig
mapa_perceptual_3D <- plot_ly(type="scatter3d")
mapa_perceptual_3D <- plot_ly()
library(plotly) #Montagem de gráficos 3D interativos
library(tidyverse) #Biblioteca com funcionalidades gerais para ciência de dados
library(ggrepel) #Afastar rótulos de texto que podem ser sobreescrever
library(knitr) #Geração de relatórios dinâmicos
library(kableExtra) #Permite criação de tabelas HTML estilizadas
library(FactoMineR) #Realizar a análise de correspondência simples
mapa_perceptual_3D <- plot_ly(type="scatter3d")
# Inserindo as coordenadas das categorias da variável disposta em linha
mapa_perceptual_3D <- add_trace(mapa_perceptual_3D,
x = coordenadas_linhas[,1],
y = coordenadas_linhas[,2],
z = coordenadas_linhas[,3],
mode = "text",
text = rownames(coordenadas_linhas),
textfont = list(color = "#440154FF"),
showlegend = FALSE)
# Inserindo as coordenadas das categorias da variável disposta em coluna
mapa_perceptual_3D <- add_trace(mapa_perceptual_3D,
x = coordenadas_colunas[,1],
y = coordenadas_colunas[,2],
z = coordenadas_colunas[,3],
mode = "text",
text = rownames(coordenadas_colunas),
textfont = list(color = "#287C8EFF"),
showlegend = FALSE)
# Inserindo o nome dos eixos (Dimensão 1, Dimensão 2 e Dimensão 3)
mapa_perceptual_3D <- layout(mapa_perceptual_3D,
scene = list(xaxis = list(title = colnames(coordenadas_linhas)[1]),
yaxis = list(title = colnames(coordenadas_linhas)[2]),
zaxis = list(title = colnames(coordenadas_linhas)[3]),
aspectmode = "data"),
margin = list(l = 0, r = 0, b = 0, t = 0))
mapa_perceptual_3D
mapa_perceptual_3D <- plotly_empty()
# Inserindo as coordenadas das categorias da variável disposta em linha
mapa_perceptual_3D <- add_trace(mapa_perceptual_3D,
x = coordenadas_linhas[,1],
y = coordenadas_linhas[,2],
z = coordenadas_linhas[,3],
mode = "text",
text = rownames(coordenadas_linhas),
textfont = list(color = "#440154FF"),
showlegend = FALSE)
# Inserindo as coordenadas das categorias da variável disposta em coluna
mapa_perceptual_3D <- add_trace(mapa_perceptual_3D,
x = coordenadas_colunas[,1],
y = coordenadas_colunas[,2],
z = coordenadas_colunas[,3],
mode = "text",
text = rownames(coordenadas_colunas),
textfont = list(color = "#287C8EFF"),
showlegend = FALSE)
# Inserindo o nome dos eixos (Dimensão 1, Dimensão 2 e Dimensão 3)
mapa_perceptual_3D <- layout(mapa_perceptual_3D,
scene = list(xaxis = list(title = colnames(coordenadas_linhas)[1]),
yaxis = list(title = colnames(coordenadas_linhas)[2]),
zaxis = list(title = colnames(coordenadas_linhas)[3]),
aspectmode = "data"),
margin = list(l = 0, r = 0, b = 0, t = 0))
mapa_perceptual_3D
mapa_perceptual_3D <- plotly()
# Inserindo as coordenadas das categorias da variável disposta em linha
mapa_perceptual_3D <- add_trace(mapa_perceptual_3D,
x = coordenadas_linhas[,1],
y = coordenadas_linhas[,2],
z = coordenadas_linhas[,3],
mode = "text",
text = rownames(coordenadas_linhas),
textfont = list(color = "#440154FF"),
showlegend = FALSE)
# Inserindo as coordenadas das categorias da variável disposta em coluna
mapa_perceptual_3D <- add_trace(mapa_perceptual_3D,
x = coordenadas_colunas[,1],
y = coordenadas_colunas[,2],
z = coordenadas_colunas[,3],
mode = "text",
text = rownames(coordenadas_colunas),
textfont = list(color = "#287C8EFF"),
showlegend = FALSE)
# Inserindo o nome dos eixos (Dimensão 1, Dimensão 2 e Dimensão 3)
mapa_perceptual_3D <- layout(mapa_perceptual_3D,
scene = list(xaxis = list(title = colnames(coordenadas_linhas)[1]),
yaxis = list(title = colnames(coordenadas_linhas)[2]),
zaxis = list(title = colnames(coordenadas_linhas)[3]),
aspectmode = "data"),
margin = list(l = 0, r = 0, b = 0, t = 0))
mapa_perceptual_3D <- plot_ly()
mapa_perceptual_3D <- plot_ly()
# Inserindo as coordenadas das categorias da variável disposta em linha
mapa_perceptual_3D <- add_trace(mapa_perceptual_3D,
x = coordenadas_linhas[,1],
y = coordenadas_linhas[,2],
z = coordenadas_linhas[,3],
mode = "text",
type="scatter3D"
text = rownames(coordenadas_linhas),
# Inserindo as coordenadas das categorias da variável disposta em linha
mapa_perceptual_3D <- add_trace(mapa_perceptual_3D,
x = coordenadas_linhas[,1],
y = coordenadas_linhas[,2],
z = coordenadas_linhas[,3],
mode = "text",
type="scatter3D",
text = rownames(coordenadas_linhas),
textfont = list(color = "#440154FF"),
showlegend = FALSE)
# Inserindo as coordenadas das categorias da variável disposta em coluna
mapa_perceptual_3D <- add_trace(mapa_perceptual_3D,
x = coordenadas_colunas[,1],
y = coordenadas_colunas[,2],
z = coordenadas_colunas[,3],
mode = "text",
text = rownames(coordenadas_colunas),
textfont = list(color = "#287C8EFF"),
showlegend = FALSE)
# Inserindo o nome dos eixos (Dimensão 1, Dimensão 2 e Dimensão 3)
mapa_perceptual_3D <- layout(mapa_perceptual_3D,
scene = list(xaxis = list(title = colnames(coordenadas_linhas)[1]),
yaxis = list(title = colnames(coordenadas_linhas)[2]),
zaxis = list(title = colnames(coordenadas_linhas)[3]),
aspectmode = "data"),
margin = list(l = 0, r = 0, b = 0, t = 0))
mapa_perceptual_3D
mapa_perceptual_3D <- plot_ly()
# Inserindo as coordenadas das categorias da variável disposta em linha
mapa_perceptual_3D <- add_trace(mapa_perceptual_3D,
x = coordenadas_linhas[,1],
y = coordenadas_linhas[,2],
z = coordenadas_linhas[,3],
mode = "text",
type="scatter3d",
text = rownames(coordenadas_linhas),
textfont = list(color = "#440154FF"),
showlegend = FALSE)
# Inserindo as coordenadas das categorias da variável disposta em coluna
mapa_perceptual_3D <- add_trace(mapa_perceptual_3D,
x = coordenadas_colunas[,1],
y = coordenadas_colunas[,2],
z = coordenadas_colunas[,3],
mode = "text",
type="scatter3d",
text = rownames(coordenadas_colunas),
textfont = list(color = "#287C8EFF"),
showlegend = FALSE)
# Inserindo o nome dos eixos (Dimensão 1, Dimensão 2 e Dimensão 3)
mapa_perceptual_3D <- layout(mapa_perceptual_3D,
scene = list(xaxis = list(title = colnames(coordenadas_linhas)[1]),
yaxis = list(title = colnames(coordenadas_linhas)[2]),
zaxis = list(title = colnames(coordenadas_linhas)[3]),
aspectmode = "data"),
margin = list(l = 0, r = 0, b = 0, t = 0))
mapa_perceptual_3D
mapa_perceptual_3D <- plot_ly()
# Inserindo as coordenadas das categorias da variável disposta em linha
mapa_perceptual_3D <- add_trace(mapa_perceptual_3D,
x = coordenadas_linhas[,1],
y = coordenadas_linhas[,2],
z = coordenadas_linhas[,3],
mode = "text",
text = rownames(coordenadas_linhas),
textfont = list(color = "#440154FF"),
showlegend = FALSE)
# Inserindo as coordenadas das categorias da variável disposta em coluna
mapa_perceptual_3D <- add_trace(mapa_perceptual_3D,
x = coordenadas_colunas[,1],
y = coordenadas_colunas[,2],
z = coordenadas_colunas[,3],
mode = "text",
text = rownames(coordenadas_colunas),
textfont = list(color = "#287C8EFF"),
showlegend = FALSE)
# Inserindo o nome dos eixos (Dimensão 1, Dimensão 2 e Dimensão 3)
mapa_perceptual_3D <- layout(mapa_perceptual_3D,
scene = list(xaxis = list(title = colnames(coordenadas_linhas)[1]),
yaxis = list(title = colnames(coordenadas_linhas)[2]),
zaxis = list(title = colnames(coordenadas_linhas)[3]),
aspectmode = "data"),
margin = list(l = 0, r = 0, b = 0, t = 0))
mapa_perceptual_3D
